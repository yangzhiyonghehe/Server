(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a48beab4"],{"09f4":function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),Math.easeInOutQuad=function(e,t,a,n){return e/=n/2,e<1?a/2*e*e+t:(e--,-a/2*(e*(e-2)-1)+t)};var n=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function r(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function s(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function i(e,t,a){var i=s(),o=e-i,l=20,c=0;t="undefined"===typeof t?500:t;var d=function e(){c+=l;var s=Math.easeInOutQuad(c,i,o,t);r(s),c<t?n(e):a&&"function"===typeof a&&a()};d()}},"2f5b":function(e,t,a){},"2fd4":function(e,t,a){"use strict";a.d(t,"d",(function(){return i})),a.d(t,"l",(function(){return o})),a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u})),a.d(t,"g",(function(){return f})),a.d(t,"f",(function(){return p})),a.d(t,"i",(function(){return h})),a.d(t,"j",(function(){return g})),a.d(t,"k",(function(){return v})),a.d(t,"h",(function(){return _})),a.d(t,"c",(function(){return k})),a.d(t,"e",(function(){return y}));a("456d"),a("ac6a"),a("96cf");var n=a("3b8d"),r=a("b775"),s=a("5c96");function i(e){return Object(r["a"])({url:"/attendance_rule/list",method:"get",params:e})}function o(e){return l.apply(this,arguments)}function l(){return l=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m(t);case 3:return e.abrupt("return",Object(r["a"])({url:"/attendance_rule/update",method:"post",timeout:12e4,data:t}));case 6:return e.prev=6,e.t0=e["catch"](0),e.abrupt("return",Promise.reject());case 9:case"end":return e.stop()}}),e,null,[[0,6]])}))),l.apply(this,arguments)}function c(e){return d.apply(this,arguments)}function d(){return d=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m(t);case 3:return e.abrupt("return",Object(r["a"])({url:"/attendance_rule/create",timeout:12e4,method:"post",data:t}));case 6:return e.prev=6,e.t0=e["catch"](0),e.abrupt("return",Promise.reject());case 9:case"end":return e.stop()}}),e,null,[[0,6]])}))),d.apply(this,arguments)}function u(e){return Object(r["a"])({url:"/attendance_rule/delete",method:"post",data:e})}function f(e){return Object(r["a"])({url:"/attendance_rule/fix_attendance",method:"post",data:e,timeout:6e4})}function m(e){return new Promise((function(t,a){Object(r["a"])({url:"/attendance_rule/check_person",method:"post",data:e}).then((function(e){var n=e.data;if(n.names.length<=0)t("");else{for(var r=[],i="",o=0;o<n.names.length;o++){if(o>=3){i="等".concat(n.names.length,"人");break}r.push(n.names[o])}i="["+r.join(",")+"]"+i,s["MessageBox"].confirm("".concat(i,"原考勤规则会被覆盖，确定吗？"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t("")})).catch((function(){a("")}))}}))}))}function p(e){return Object(r["a"])({url:"/attendance_rule/fetchTakeTurns",method:"get",params:{id:e}})}function h(e){return b.apply(this,arguments)}function b(){return b=Object(n["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,a=[],Object.keys(t.persons).forEach((function(e){t.persons[e]&&a.push(e)})),e.next=5,m(Object.assign({person:a},t));case 5:return e.abrupt("return",Object(r["a"])({url:"/attendance_rule/saveTakeTurns",method:"post",data:t}));case 8:return e.prev=8,e.t0=e["catch"](0),e.abrupt("return",Promise.reject());case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),b.apply(this,arguments)}function g(e){return Object(r["a"])({url:"/attendance_rule/schedule",method:"post",data:e})}function v(e){return Object(r["a"])({url:"/attendance_rule/selectedPersons",method:"get",params:e})}function _(e){return Object(r["a"])({url:"/attendance/list",method:"get",params:e})}function k(e){return Object(r["a"])({url:"/attendance/export",method:"get",timeout:12e4,params:e})}function y(e){return Object(r["a"])({url:"/attendance/snap",method:"get",params:e})}},"313f":function(e,t,a){"use strict";var n=a("2f5b"),r=a.n(n);r.a},"3f6e":function(e,t,a){"use strict";a.d(t,"e",(function(){return r})),a.d(t,"j",(function(){return s})),a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"g",(function(){return l})),a.d(t,"f",(function(){return c})),a.d(t,"h",(function(){return d})),a.d(t,"a",(function(){return u})),a.d(t,"i",(function(){return f})),a.d(t,"d",(function(){return m}));var n=a("b775");function r(e){return Object(n["a"])({url:"/person/list",method:"get",params:e})}function s(e){return Object(n["a"])({url:"/person/update",method:"post",data:e})}function i(e){return Object(n["a"])({url:"/person/create",method:"post",data:e})}function o(e){return Object(n["a"])({url:"/person/delete",method:"post",data:e})}function l(e){return Object(n["a"])({url:"/person/personSelectedDevice",method:"post",params:e})}function c(e){return Object(n["a"])({url:"/person/personOrgOptions",method:"post",params:e})}function d(e){return Object(n["a"])({url:"/person/sync",method:"post",hiddenMsg:!0,data:e})}function u(e){return Object(n["a"])({url:"/person/bindAdmin",method:"post",data:e})}function f(e){return Object(n["a"])({url:"/person/unbind",method:"post",data:{company_id:e}})}function m(e){return Object(n["a"])({url:"/person/fetchAdmin",method:"post",data:e})}},"409b":function(e,t,a){"use strict";var n=a("7b50"),r=a.n(n);r.a},4678:function(e,t,a){var n={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"73332","./en-il.js":"73332","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df48","./fa.js":"8df48","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b46","./gd.js":"f6b46","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"50385","./id.js":"50385","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e9","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e9","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function r(e){var t=s(e);return a(t)}function s(e){var t=n[e];if(!(t+1)){var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}return t}r.keys=function(){return Object.keys(n)},r.resolve=s,e.exports=r,r.id="4678"},6566:function(e,t,a){"use strict";var n=a("6704"),r=a.n(n);r.a},6704:function(e,t,a){},6724:function(e,t,a){"use strict";a("8d41");var n="@@wavesContext";function r(e,t){function a(a){var n=Object.assign({},t.value),r=Object.assign({ele:e,type:"hit",color:"rgba(0, 0, 0, 0.15)"},n),s=r.ele;if(s){s.style.position="relative",s.style.overflow="hidden";var i=s.getBoundingClientRect(),o=s.querySelector(".waves-ripple");switch(o?o.className="waves-ripple":(o=document.createElement("span"),o.className="waves-ripple",o.style.height=o.style.width=Math.max(i.width,i.height)+"px",s.appendChild(o)),r.type){case"center":o.style.top=i.height/2-o.offsetHeight/2+"px",o.style.left=i.width/2-o.offsetWidth/2+"px";break;default:o.style.top=(a.pageY-i.top-o.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",o.style.left=(a.pageX-i.left-o.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return o.style.backgroundColor=r.color,o.className="waves-ripple z-active",!1}}return e[n]?e[n].removeHandle=a:e[n]={removeHandle:a},a}var s={bind:function(e,t){e.addEventListener("click",r(e,t),!1)},update:function(e,t){e.removeEventListener("click",e[n].removeHandle,!1),e.addEventListener("click",r(e,t),!1)},unbind:function(e){e.removeEventListener("click",e[n].removeHandle,!1),e[n]=null,delete e[n]}},i=function(e){e.directive("waves",s)};window.Vue&&(window.waves=s,Vue.use(i)),s.install=i;t["a"]=s},"7b50":function(e,t,a){},"80c2":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-dropdown",{staticStyle:{"margin-left":"10px"},attrs:{trigger:"click"},on:{command:e.handleCreate}},[a("el-button",{attrs:{type:"primary"}},[e._v("\n        "+e._s(e.$t("rule.add"))),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:1}},[e._v(e._s(e.$t("rule.normalModel")))]),e._v(" "),a("el-dropdown-item",{attrs:{command:2}},[e._v(e._s(e.$t("rule.takeTurnModel")))])],1)],1),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-date"},on:{click:e.handleSchedule}},[e._v(e._s(e.$t("rule.schedule")))]),e._v(" "),a("el-button",{attrs:{type:"warning",icon:"el-icon-date"},on:{click:e.handleFixed}},[e._v("\n      "+e._s(e.$t("rule.updateAttendance"))+"\n    ")])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.list,border:"",fit:"","highlight-current-row":""},on:{"sort-change":e.sortChange}},[a("el-table-column",{attrs:{label:"ID",prop:"id",sortable:"custom",align:"center",width:"80","class-name":e.getSortClass("id")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.id))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("rule.name"),"min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("rule.rateTime"),width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[0===n.type?a("span",[e._v(e._s(e.ratetime(n)))]):a("el-tag",{attrs:{type:"info"}},[e._v(e._s(e.$t("rule.hidden")))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("rule.rateWeek"),width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(e.getDaysName(n.days)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("table.actions"),align:"center",width:"230","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleUpdate(n)}}},[e._v(e._s(e.$t("table.modify")))]),e._v(" "),"deleted"!=n.status?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(n)}}},[e._v(e._s(e.$t("table.delete")))]):e._e()]}}])})],1),e._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.listQuery.page,limit:e.listQuery.limit},on:{"update:page":function(t){return e.$set(e.listQuery,"page",t)},"update:limit":function(t){return e.$set(e.listQuery,"limit",t)},pagination:e.getList}}),e._v(" "),a("el-dialog",{attrs:{title:e.$t("rule.normalModelTitle"),visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"dataForm",staticStyle:{width:"580px","margin-left":"50px"},attrs:{rules:e.rules,model:e.temp,"label-position":"left","label-width":"120px"}},[a("el-form-item",{attrs:{label:e.$t("rule.ruleName"),prop:"name"}},[a("el-input",{model:{value:e.temp.name,callback:function(t){e.$set(e.temp,"name",t)},expression:"temp.name"}})],1),e._v(" "),a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:e.$t("rule.tabs.rule"),name:"first"}},[a("el-form-item",{attrs:{label:e.$t("rule.rateWeek"),prop:"attendance_days"}},[a("el-checkbox-group",{attrs:{size:"small"},model:{value:e.attendance_days,callback:function(t){e.attendance_days=t},expression:"attendance_days"}},e._l(e.days,(function(t){return a("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.name))])})),1)],1),e._v(" "),a("fixed-com",{attrs:{form:e.temp},on:{"update:form":function(t){e.temp=t}}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:e.$t("rule.tabs.persons"),name:"second"}},[a("el-form-item",{attrs:{label:e.$t("rule.persons"),prop:"person"}},[a("el-tree",{ref:"personTree",attrs:{data:e.person_options,"show-checkbox":"","node-key":"id","default-expand-all":!0,"default-checked-keys":e.selected_persons,props:e.defaultProps}})],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("div",{staticStyle:{color:"red",float:"left"}},[e._v(e._s(e.$t("rule.form.tips")))]),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("rule.form.syncTips"),placement:"top"}},[a("el-checkbox",{model:{value:e.temp.sync,callback:function(t){e.$set(e.temp,"sync",t)},expression:"temp.sync"}},[e._v(e._s(e.$t("rule.form.sync")))])],1),e._v(" "),a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("\n        "+e._s(e.$t("table.cancel"))+"\n      ")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){"create"===e.dialogStatus?e.createData():e.updateData()}}},[e._v("\n        "+e._s(e.$t("table.submit"))+"\n      ")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.$t("rule.takeTurnModelTitle"),visible:e.dialogTakVisible,width:e.visTree?"70%":"50%"},on:{"update:visible":function(t){e.dialogTakVisible=t}}},[e.dialogTakVisible?a("take-turns",{attrs:{id:e.temp.id,visible:e.dialogTakVisible,persons:e.person_options,"vis-tree":e.visTree},on:{"update:visible":function(t){e.dialogTakVisible=t},"update:visTree":function(t){e.visTree=t},"update:vis-tree":function(t){e.visTree=t}}}):e._e()],1),e._v(" "),a("el-dialog",{attrs:{title:e.$t("rule.schedule"),visible:e.dialogScheduleVisible,width:"70%"},on:{"update:visible":function(t){e.dialogScheduleVisible=t}}},[e.dialogScheduleVisible?a("schedule-com",{attrs:{datas:e.scheduleDatas,headers:e.scheduleHeaders}}):e._e()],1),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogFixVisible,"before-close":e.cancelFixAttendance},on:{"update:visible":function(t){e.dialogFixVisible=t}}},[a("div",{staticStyle:{color:"#555"},attrs:{slot:"title"},slot:"title"},[e._v("\n      "+e._s(e.$t("rule.updateAtt.title"))+"\n      "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("rule.updateAtt.tips"),placement:"right"}},[a("i",{staticClass:"el-icon-question"})])],1),e._v(" "),a("div",{staticClass:"fix-dialog"},[a("div",{staticClass:"calendar"},[a("el-calendar",{scopedSlots:e._u([{key:"dateCell",fn:function(t){t.date;var n=t.data;return[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.fixLoading(n.day),expression:"fixLoading(data.day)"}],staticClass:"day-cell",class:{checked:e.renderChooseChecked(n.day)},on:{click:function(t){return e.chooseDay(n.day)}}},[e._v("\n              "+e._s(n.day.split("-").slice(2).join("-"))+"\n              "),a("i",{directives:[{name:"show",rawName:"v-show",value:e.renderChooseChecked(n.day),expression:"renderChooseChecked(data.day)"}],class:e.renderFixIcon(n.day)})])]}}]),model:{value:e.fixCurrentDay,callback:function(t){e.fixCurrentDay=t},expression:"fixCurrentDay"}})],1)]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelFixAttendance}},[e._v("\n        "+e._s(e.$t("table.cancel"))+"\n      ")]),e._v(" "),a("el-button",{attrs:{loading:!e.cancelFix,type:"primary",icon:"el-icon-sunny"},on:{click:function(t){return e.handleFixAttendance()}}},[e._v("\n        "+e._s(e.$t("rule.updateAtt.btn"))+"\n      ")])],1)])],1)},r=[],s=(a("ac4d"),a("8a81"),a("28a5"),a("7f7f"),a("55dd"),a("20d6"),a("7618")),i=(a("ac6a"),a("2fd4")),o=a("3f6e"),l=a("6724"),c=a("333d"),d=a("c466"),u=a("c1df"),f=a.n(u),m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[a("div",{staticClass:"tak-wrap"},[a("div",{staticClass:"rule-box",style:{width:e.visTree?"70%":"100%"}},[a("div",{staticStyle:{padding:"0 0 10px 0"}},[a("el-form-item",{staticStyle:{"margin-bottom":"15px"},attrs:{label:e.$t("rule.model.ruleName"),required:""}},[a("el-input",{staticStyle:{width:"320px",margin:"0 20px 0 0"},attrs:{placeholder:e.$t("rule.model.ruleName")},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1)],1),e._v(" "),a("div",{staticClass:"groups"},[a("draggable",{attrs:{list:e.tags,options:{animation:150},group:{name:"tags",pull:"clone"}}},[a("transition-group",e._l(e.tags,(function(t){return a("el-tag",{key:t.index,staticClass:"tag",attrs:{size:"default","disable-transitions":!1,effect:t.active?"plain":"dark",color:t.form["color"]},on:{click:function(a){return e.handleChoose(t)}}},[e._v(e._s(t.form["name"]))])})),1)],1),e._v(" "),e.inputVisible?a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:e.handleAddTag},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleAddTag(t)}},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}}):e._e(),e._v(" "),a("el-dropdown",{staticStyle:{margin:"0 10px"},attrs:{"split-button":"",size:"small"},on:{click:e.showInput,command:e.handleClone}},[e._v("\n            "+e._s(e.$t("rule.model.addNew"))+"\n            "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.tags,(function(t,n){return a("el-dropdown-item",{key:n,attrs:{command:n}},[e._v(e._s(t.form["name"]))])})),1)],1),e._v(" "),a("draggable",{staticClass:"trash",attrs:{group:"tags"},on:{add:e.removeTag}},[a("el-popover",{attrs:{placement:"right",trigger:"click",content:e.$t("rule.model.removeTips")}},[a("el-button",{attrs:{slot:"reference",icon:"el-icon-delete",size:"small"},slot:"reference"})],1)],1)],1),e._v(" "),Object.keys(e.form).length?a("el-divider",[e._v(e._s(e.$t("rule.model.settings")))]):e._e(),e._v(" "),Object.keys(e.form).length?a("div",{staticClass:"rule-wrap"},[a("el-row",{attrs:{gutter:2}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:e.$t("rule.model.ttName"),required:""}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:3}},[a("el-color-picker",{model:{value:e.form.color,callback:function(t){e.$set(e.form,"color",t)},expression:"form.color"}})],1),e._v(" "),a("el-col",{attrs:{span:13}},[a("el-radio-group",{staticStyle:{margin:"2px 0 0 0"},attrs:{size:"small"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[a("el-radio",{staticClass:"type",attrs:{label:0,border:""}},[e._v(e._s(e.$t("rule.model.rest")))]),e._v(" "),a("el-radio",{staticClass:"type",attrs:{label:1,border:""}},[e._v(e._s(e.$t("rule.model.range1")))]),e._v(" "),a("el-radio",{staticClass:"type",attrs:{label:2,border:""}},[e._v(e._s(e.$t("rule.model.range2")))]),e._v(" "),a("el-radio",{staticClass:"type",attrs:{label:3,border:""}},[e._v(e._s(e.$t("rule.model.range3")))])],1)],1)],1),e._v(" "),e.form.type>0?a("el-tabs",{attrs:{"tab-position":"left"},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[e.form.type>0?a("el-tab-pane",{attrs:{label:e.$t("rule.model.name1"),name:"first"}},[a("rule-atte",{attrs:{form:e.form.range1,first:!0,last:1==e.form.type,comindex:1},on:{"update:form":function(t){return e.$set(e.form,"range1",t)}}})],1):e._e(),e._v(" "),e.form.type>1?a("el-tab-pane",{attrs:{label:e.$t("rule.model.name2"),name:"second"}},[a("rule-atte",{attrs:{form:e.form.range2,first:!1,last:2==e.form.type,comindex:2},on:{"update:form":function(t){return e.$set(e.form,"range2",t)}}})],1):e._e(),e._v(" "),e.form.type>2?a("el-tab-pane",{attrs:{label:e.$t("rule.model.name3"),name:"third"}},[a("rule-atte",{attrs:{form:e.form.range3,first:!1,last:!0,comindex:3},on:{"update:form":function(t){return e.$set(e.form,"range3",t)}}})],1):e._e()],1):e._e()],1):e._e(),e._v(" "),a("div",[a("el-divider",[e._v(e._s(e.$t("rule.model.scheduling")))])],1),e._v(" "),a("div",{staticStyle:{margin:"0 0 10px 0"}},[e._v("\n          "+e._s(e.$t("rule.model.beginRange"))+":\n          "),e.tags.length?e._e():a("el-tag",{attrs:{type:"info",size:"small"}},[e._v("("+e._s(e.$t("rule.model.beginRangeTips"))+")")]),e._v(" "),e._l(e.tags,(function(t,n){return a("el-tag",{key:n,staticClass:"tag",attrs:{size:"default","disable-transitions":!1,effect:t.selected?"plain":"dark",color:t.form["color"]},on:{click:function(a){return e.handleChooseTag(t)}}},[e._v(e._s(t.form["name"]))])}))],2),e._v(" "),a("div",[e._v("\n          "+e._s(e.$t("rule.model.beginDate"))+":\n          "),a("el-date-picker",{attrs:{type:"date",size:"small",placeholder:e.$t("rule.model.beginDatePlaceholder")},model:{value:e.begin,callback:function(t){e.begin=t},expression:"begin"}}),e._v(" "),a("el-tag",{attrs:{type:"info",size:"small"}},[e._v("("+e._s(e.$t("rule.model.beginDateTips"))+")")])],1)],1),e._v(" "),e.visTree?a("div",{staticClass:"tree-box",style:{width:e.visTree?"30%":"0"}},[a("el-divider",[e._v("【"+e._s(e.selectTag)+"】")]),e._v(" "),a("el-tree",{ref:"personTree",attrs:{data:e.persons,"show-checkbox":"","node-key":"id","default-expand-all":!0,props:{children:"children",label:"name"}},on:{"check-change":e.checkChange}})],1):e._e()])]),e._v(" "),a("el-row",[a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:24}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("rule.form.syncTips"),placement:"top"}},[a("el-checkbox",{model:{value:e.sync,callback:function(t){e.sync=t},expression:"sync"}},[e._v(e._s(e.$t("rule.form.sync")))])],1),e._v(" "),a("el-button",{on:{click:e.handleHidden}},[e._v("\n        "+e._s(e.$t("table.cancel"))+"\n      ")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.updateData()}}},[e._v("\n        "+e._s(e.$t("table.submit"))+"\n      ")])],1)],1)],1)},p=[],h=(a("456d"),a("c5f6"),a("1980")),b=a.n(h),g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{attrs:{"label-width":"120px"}},[a("el-form-item",{staticStyle:{"margin-bottom":"15px"},attrs:{label:e.$t("rule.rateTime"),required:""}},[a("el-col",{attrs:{span:7}},[a("el-form-item",{attrs:{prop:"time1"}},[a("el-time-picker",{staticStyle:{width:"100%"},attrs:{"picker-options":{selectableRange:"00:00:00 - 23:59:59",format:"HH:mm"},"value-format":"HH:mm",format:"HH:mm",placeholder:e.$t("rule.workPlaceholder")},model:{value:e.temp.time1,callback:function(t){e.$set(e.temp,"time1",t)},expression:"temp.time1"}})],1)],1),e._v(" "),a("el-col",{staticClass:"line",staticStyle:{"text-align":"center"},attrs:{span:2}},[e._v("-")]),e._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"time2"}},[a("el-time-picker",{staticStyle:{width:"120px",display:"inline-block"},attrs:{"picker-options":{selectableRange:"00:00:00 - 23:59:59",format:"HH:mm"},"value-format":"HH:mm",format:"HH:mm",placeholder:e.$t("rule.offworkPlaceholder")},model:{value:e.temp.time2,callback:function(t){e.$set(e.temp,"time2",t)},expression:"temp.time2"}}),e._v(" "),e.showTag(e.temp.time1,e.temp.time2)?a("el-tag",{attrs:{type:"warning"}},[e._v(e._s(e.tagText(e.temp.time1,e.temp.time2)))]):e._e()],1)],1)],1),e._v(" "),a("el-row",{staticStyle:{padding:"0 0 15px 0"}},[a("el-col",{attrs:{span:8,offset:6}},[a("el-checkbox",{attrs:{disabled:e.first},model:{value:e.temp.workcheck,callback:function(t){e.$set(e.temp,"workcheck",t)},expression:"temp.workcheck"}},[e._v(e._s(e.$t("rule.components.workCheck")))])],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-checkbox",{attrs:{disabled:e.last},model:{value:e.temp.offworkcheck,callback:function(t){e.$set(e.temp,"offworkcheck",t)},expression:"temp.offworkcheck"}},[e._v(e._s(e.$t("rule.components.offworkCheck")))])],1)],1),e._v(" "),e.temp.workcheck?a("el-form-item",{attrs:{label:e.$t("rule.workTime"),required:""}},[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"work_begin","label-width":"0"}},[a("el-time-picker",{staticStyle:{width:"130px",display:"inline-block"},attrs:{"picker-options":{selectableRange:"00:00:00 - 23:59:59",format:"HH:mm"},"value-format":"HH:mm",format:"HH:mm",placeholder:e.$t("rule.placeholder.workBegin")},model:{value:e.temp.work_begin,callback:function(t){e.$set(e.temp,"work_begin",t)},expression:"temp.work_begin"}}),e._v(" "),e.showTag(e.temp.time1,e.temp.work_begin,-1)?a("el-tag",{attrs:{type:"warning"}},[e._v(e._s(e.tagText(e.temp.time1,e.temp.work_begin)))]):e._e()],1)],1),e._v(" "),a("el-col",{staticClass:"line",staticStyle:{"text-align":"center"},attrs:{span:2}},[e._v("-")]),e._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"work_end","label-width":"0"}},[a("el-time-picker",{staticStyle:{width:"130px",display:"inline-block"},attrs:{"picker-options":{selectableRange:"00:00:00 - 23:59:59",format:"HH:mm"},"value-format":"HH:mm",format:"HH:mm",placeholder:e.$t("rule.placeholder.workEnd")},model:{value:e.temp.work_end,callback:function(t){e.$set(e.temp,"work_end",t)},expression:"temp.work_end"}}),e._v(" "),e.showTag(e.temp.time1,e.temp.work_end)?a("el-tag",{attrs:{type:"warning"}},[e._v(e._s(e.tagText(e.temp.time1,e.temp.work_end)))]):e._e()],1)],1)],1):e._e(),e._v(" "),e.temp.offworkcheck?a("el-form-item",{attrs:{label:e.$t("rule.offworkTime"),required:""}},[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"offwork_begin","label-width":"0"}},[a("el-time-picker",{staticStyle:{width:"130px",display:"inline-block"},attrs:{"picker-options":{selectableRange:"00:00:00 - 23:59:59",format:"HH:mm"},"value-format":"HH:mm",format:"HH:mm",placeholder:e.$t("rule.placeholder.offworkBegin")},model:{value:e.temp.offwork_begin,callback:function(t){e.$set(e.temp,"offwork_begin",t)},expression:"temp.offwork_begin"}}),e._v(" "),e.showTag(e.temp.time1,e.temp.offwork_begin)?a("el-tag",{attrs:{type:"warning"}},[e._v(e._s(e.tagText(e.temp.time1,e.temp.offwork_begin)))]):e._e()],1)],1),e._v(" "),a("el-col",{staticClass:"line",staticStyle:{"text-align":"center"},attrs:{span:2}},[e._v("-")]),e._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"offwork_end","label-width":"0"}},[a("el-time-picker",{staticStyle:{width:"130px",display:"inline-block"},attrs:{"picker-options":{selectableRange:"00:00:00 - 23:59:59",format:"HH:mm"},"value-format":"HH:mm",format:"HH:mm",placeholder:e.$t("rule.placeholder.offworkEnd")},model:{value:e.temp.offwork_end,callback:function(t){e.$set(e.temp,"offwork_end",t)},expression:"temp.offwork_end"}}),e._v(" "),e.showTag(e.temp.time1,e.temp.offwork_end)?a("el-tag",{attrs:{type:"warning"}},[e._v(e._s(e.tagText(e.temp.time1,e.temp.offwork_end)))]):e._e()],1)],1)],1):e._e(),e._v(" "),e.temp.workcheck?a("el-form-item",{attrs:{label:e.$t("rule.lateTime"),prop:"late_time"}},[a("el-input",{attrs:{type:"number",placeholder:e.$t("rule.placeholder.lateTime")},model:{value:e.temp.late_time,callback:function(t){e.$set(e.temp,"late_time",t)},expression:"temp.late_time"}},[a("template",{slot:"append"},[e._v(e._s(e.$t("date.minute")))])],2)],1):e._e(),e._v(" "),e.temp.offworkcheck?a("el-form-item",{attrs:{label:e.$t("rule.leftEarly"),prop:"left_early"}},[a("el-input",{attrs:{type:"number",placeholder:e.$t("rule.placeholder.leftEarly")},model:{value:e.temp.left_early,callback:function(t){e.$set(e.temp,"left_early",t)},expression:"temp.left_early"}},[a("template",{slot:"append"},[e._v(e._s(e.$t("date.minute")))])],2)],1):e._e()],1)},v=[],_={name:"RuleAtte",props:{form:{type:Object,default:function(){return{}}},first:{type:Boolean,default:!1},last:{type:Boolean,default:!1}},data:function(){return{time_keys:["time1","time2","work_begin","work_end","offwork_begin","offwork_end"],temp:{time1:"",time2:"",workcheck:!0,offworkcheck:!0,late_time:"",left_early:"",work_begin:"",work_end:"",offwork_begin:"",offwork_end:""}}},watch:{last:function(e,t){this.$set(this.temp,"offworkcheck",!0)},first:function(e,t){this.$set(this.temp,"workcheck",!0)},form:{immediate:!0,handler:function(e,t){if(Object.keys(e).length<=0)return"";this.temp=e}}},mounted:function(){this.$emit("update:form",this.temp),this.first&&this.$set(this.temp,"workcheck",!0),this.last&&this.$set(this.temp,"offworkcheck",!0)},methods:{initTemp:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign({name:"",time1:"",time2:"",workcheck:!0,offworkcheck:!0,late_time:"",left_early:"",work_begin:"",work_end:"",offwork_begin:"",offwork_end:""},e)},tagText:function(e,t){return 1===Object(d["a"])(e,t)?this.$t("rule.components.tomorrow"):this.$t("rule.components.yesterday")},showTag:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return!(!e||!t)&&Object(d["a"])(e,t)===1*a}}},k=_,y=a("2877"),w=Object(y["a"])(k,g,v,!1,null,null,null),j=w.exports,x={name:"TakeTurns",components:{draggable:b.a,RuleAtte:j},props:{id:{type:Number,default:null},persons:{type:Array,default:function(){return[]}},visTree:{type:Boolean,default:!1},visible:{type:Boolean,default:!1}},data:function(){return{name:"",begin:"",tags:[],tagIndex:0,inputVisible:!1,inputValue:"",form:{},selectTag:"",takIndex:0,activeTab:"first",sync:!1,personGroup:{}}},computed:{},watch:{"form.range1":{deep:!0,handler:function(e,t){var a=this.getTagIndex();null!==a&&(this.tags[a]["form"]["range1"]=e)}},"form.range2":{deep:!0,handler:function(e,t){var a=this.getTagIndex();null!==a&&(this.tags[a]["form"]["range2"]=e)}},"form.range3":{deep:!0,handler:function(e,t){var a=this.getTagIndex();null!==a&&(this.tags[a]["form"]["range3"]=e)}},"form.color":{deep:!0,handler:function(e,t){if(this.tags.length>this.tagIndex){var a=this.getTagIndex();this.tags[a]["color"]=e}}}},mounted:function(){var e=this;this.id>0?Object(i["f"])(this.id).then((function(t){var a=t.data;e.name=a.name,e.begin=a.begin,e.tags=a.tags,e.tags.length>0&&(e.form=e.tempForm(a.tags[0].form)),e.resetChoose(),Object.keys(a.persons).forEach((function(t){e.personGroup[t]=a.persons[t]}))})):(this.form=this.tempForm(),this.resetChoose()),this.personGroup=this.resetPersonGroup(this.persons)},methods:{parseForm:function(e){return void 0!==e.late_time&&(""===e.late_time&&(e.late_time=-1),e.late_time=parseInt(e.late_time)),void 0!==e.left_early&&(""===e.left_early&&(e.left_early=-1),e.left_early=parseInt(e.left_early)),e},handleHidden:function(){this.$emit("update:visible",!1)},updateData:function(){for(var e=this,t=JSON.parse(JSON.stringify({id:this.id,name:this.name,begin:this.begin,tags:this.tags,persons:this.personGroup,sync:this.sync})),a=0;a<t.tags.length;a++){var n=t.tags[a].form;n["range1"]=this.parseForm(n["range1"]),n["range2"]=this.parseForm(n["range2"]),n["range3"]=this.parseForm(n["range3"]),t.tags[a].form=n}Object(i["i"])(t).then((function(t){e.sync=!1,e.$notify({title:e.$t("table.successTitle"),message:t.message||e.$t("table.updateSuccess"),type:"success",duration:2e3}),e.$parent.$parent.getList(),e.handleHidden()}))},getSelected:function(e){var t=this,a=[];return Object.keys(this.personGroup).forEach((function(n){t.personGroup[n]===e&&a.push(parseInt(n))})),a},resetPersonGroup:function(e){var t=this,a={};return e.forEach((function(e){e["children"]&&e["children"].length>0&&(a=Object.assign(a,t.resetPersonGroup(e["children"]))),"number"===typeof e["id"]&&(a[e["id"]]=null)})),a},checkChange:function(e,t,a){var n=this;Object.keys(this.personGroup).forEach((function(a){if(parseInt(a)!==e.id)return!1;t?n.personGroup[a]=n.takIndex:n.personGroup[a]===n.takIndex&&(n.personGroup[a]=null)}))},getTagIndex:function(){var e=this,t=null;return this.tags.forEach((function(a,n){a.index===e.tagIndex&&(t=n)})),t},tempForm:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign({name:"",color:"",type:0,activeTab:"first",range1:{},range2:{},range3:{}},e)},tempTag:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.tempForm(e["form"]||{}),a=this.tags.length;return e["form"]&&delete e.form,Object.assign({id:0,index:a,name:"",active:!1,selected:!1,form:t},e)},resetChoose:function(){this.tags.length>0?this.handleChoose(this.tags[0]):this.form={}},handleClone:function(e){var t=JSON.parse(JSON.stringify(this.tags[e]));t=Object.assign(t,{id:0,index:this.tags.length,active:!1,selected:!1}),this.tags.push(t),this.handleChoose(t)},removeTag:function(e){var t=this,a=this.tags[e.oldIndex],n=!!a.active;this.$confirm(this.$t("rule.model.deleteTitle"),this.$t("table.confirmTitle")).then((function(a){t.tags.splice(e.oldIndex,1),n&&t.resetChoose()}))},handleChooseTag:function(e){var t=this,a=!e.selected;this.selectTag=e.form["name"],this.takIndex=e.index,this.tags.forEach((function(t){t.selected=t===e&&a})),this.$emit("update:visTree",a),this.$nextTick((function(){a&&t.$refs.personTree.setCheckedKeys(t.getSelected(e.index))}))},handleChoose:function(e){this.tags.forEach((function(e){e.active=!1})),e.active=!0,this.form=e.form,this.tagIndex=e.index,this.activeTab="first"},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick((function(t){e.$refs.saveTagInput.$refs.input.focus()}))},handleAddTag:function(){var e=this.inputValue;if(e){var t=this.tempTag({name:e,form:{name:e}});this.tags.push(t),this.handleChoose(t)}this.inputVisible=!1,this.inputValue=""}}},$=x,T=(a("313f"),Object(y["a"])($,m,p,!1,null,"c399e304",null)),O=T.exports,C=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-table",{attrs:{data:Object.keys(e.datas)}},[a("el-table-column",{attrs:{label:e.$t("rule.components.uname")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n))])]}}])}),e._v(" "),e._l(e.headers,(function(t,n){return a("el-table-column",{key:n,scopedSlots:e._u([{key:"default",fn:function(n){var r=n.row;return[e.datas[r][t]?a("el-tag",{attrs:{color:e.datas[r][t].color,effect:"dark"}},[e._v("\n          "+e._s(e.datas[r][t].name)+"\n        ")]):a("el-tag",[e._v(e._s(e.$t("rule.components.empty")))])]}}],null,!0)},[a("template",{slot:"header"},[e._v("\n        "+e._s(t)+"\n      ")])],2)}))],2)],1)},S=[],F={name:"Schedule",props:{datas:{type:Object,default:function(){return[]}},headers:{type:Array,default:function(){return[]}}}},D=F,H=Object(y["a"])(D,C,S,!1,null,null,null),V=H.exports,z=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form-item",{attrs:{label:e.$t("rule.model.rangeNum"),required:""}},[a("el-radio-group",{staticClass:"radio-group",staticStyle:{margin:"2px 0 0 0"},attrs:{size:"small"},model:{value:e.form.checktype,callback:function(t){e.$set(e.form,"checktype",t)},expression:"form.checktype"}},[a("el-radio",{staticClass:"type",attrs:{label:1,border:""}},[e._v(e._s(e.$t("rule.model.range1")))]),e._v(" "),a("el-radio",{staticClass:"type",attrs:{label:2,border:""}},[e._v(e._s(e.$t("rule.model.range2")))]),e._v(" "),a("el-radio",{staticClass:"type",attrs:{label:3,border:""}},[e._v(e._s(e.$t("rule.model.range3")))])],1)],1),e._v(" "),1==e.form.checktype?a("rule-atte",{attrs:{form:e.form.range1,first:!0,last:1==e.form.checktype,comindex:e.activeTab},on:{"update:form":function(t){return e.$set(e.form,"range1",t)}}}):a("el-tabs",{attrs:{"tab-position":"left"},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[e.form.checktype>0?a("el-tab-pane",{attrs:{label:e.$t("rule.model.name1"),name:"first"}},[a("rule-atte",{attrs:{form:e.form.range1,first:!0,last:1==e.form.checktype,comindex:e.activeTab},on:{"update:form":function(t){return e.$set(e.form,"range1",t)}}})],1):e._e(),e._v(" "),e.form.checktype>1?a("el-tab-pane",{attrs:{label:e.$t("rule.model.name2"),name:"second"}},[a("rule-atte",{attrs:{form:e.form.range2,first:!1,last:2==e.form.checktype,comindex:e.activeTab},on:{"update:form":function(t){return e.$set(e.form,"range2",t)}}})],1):e._e(),e._v(" "),e.form.checktype>2?a("el-tab-pane",{attrs:{label:e.$t("rule.model.name3"),name:"third"}},[a("rule-atte",{attrs:{form:e.form.range3,first:!1,last:!0,comindex:e.activeTab},on:{"update:form":function(t){return e.$set(e.form,"range3",t)}}})],1):e._e()],1)],1)},I=[],E={name:"RuleModelFixed",components:{RuleAtte:j},props:{form:{type:Object,default:function(){return{}}}},data:function(){return{activeTab:"first"}},watch:{"form.checktype":{deep:!0,handler:function(e,t){this.activeTab="first"}}},mounted:function(){},methods:{}},N=E,q=(a("6566"),Object(y["a"])(N,z,I,!1,null,"b150f542",null)),A=q.exports,L={name:"List",components:{Pagination:c["a"],TakeTurns:O,"schedule-com":V,"fixed-com":A},directives:{waves:l["a"]},data:function(){return{tableKey:0,list:null,total:0,listLoading:!0,listQuery:{page:1,limit:20,name:void 0,sort:"+id"},activeName:"first",attendance_days:[],person_options:[],selected_persons:[],defaultProps:{children:"children",label:"name"},days:[{id:"1",name:this.$t("date.week.w1")},{id:"2",name:this.$t("date.week.w2")},{id:"3",name:this.$t("date.week.w3")},{id:"4",name:this.$t("date.week.w4")},{id:"5",name:this.$t("date.week.w5")},{id:"6",name:this.$t("date.week.w6")},{id:"7",name:this.$t("date.week.w7")}],time_keys:["time1","time2","work_begin","work_end","offwork_begin","offwork_end"],temp:{id:void 0,name:"",person:[],days:"",checktype:1,range1:{time1:"",time2:"",late_time:"",left_early:"",work_begin:"",work_end:"",offwork_begin:"",offwork_end:""},range2:{},range3:{},sync:!1},dialogFormVisible:!1,dialogTakVisible:!1,dialogScheduleVisible:!1,dialogFixVisible:!1,visTree:!1,dialogStatus:"",scheduleDatas:{},scheduleHeaders:[],selectedDay:[],fixedDay:[],cancelFix:!0,fixCurrentDay:new Date,rules:{name:[{required:!0,message:this.$t("rule.required.name"),trigger:"blur"}],time1:[{required:!0,message:this.$t("rule.required.time1"),trigger:"blur"}],time2:[{required:!0,message:this.$t("rule.required.time2"),trigger:"blur"}],work_begin:[{required:!0,message:this.$t("rule.required.time"),trigger:"blur"}],work_end:[{required:!0,message:this.$t("rule.required.time"),trigger:"blur"}],offwork_begin:[{required:!0,message:this.$t("rule.required.time"),trigger:"blur"}],offwork_end:[{required:!0,message:this.$t("rule.required.time"),trigger:"blur"}]},downloadLoading:!1}},watch:{temp:{handler:function(e,t){var a=this;this.time_keys.forEach((function(t){var n=e[t];"object"===Object(s["a"])(n)&&0!==n.getSeconds()&&(n.setSeconds(0),a.temp[t]=n)}))},deep:!0},dialogFormVisible:function(e,t){e||this.$set(this.temp,"checktype",0)}},created:function(){this.getList(),this.getOptions()},methods:{handleFixed:function(){this.dialogFixVisible=!0},chooseDay:function(e){var t=this.selectedDay.findIndex((function(t){return t===e}));t<0?this.selectedDay.push(e):this.selectedDay.splice(t,1),this.selectedDay.sort((function(e,t){return f()(e).unix()-f()(t).unix()}))},renderChooseChecked:function(e){return this.selectedDay.some((function(t){return e===t}))},fixLoading:function(e){return!this.cancelFix&&e===f()(this.fixCurrentDay).format("YYYY-MM-DD")},renderFixIcon:function(e){return this.fixedDay.some((function(t){return t===e}))?"el-icon-success":"el-icon-circle-check"},handleFixAttendance:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(t||this.selectedDay.length>0&&(t=this.selectedDay.slice(0),this.fixedDay=[],this.cancelFix=!1),t){var a=t[0];this.fixCurrentDay=f()(a).toDate(),Object(i["g"])({date:a}).then((function(n){e.cancelFix||(e.fixedDay.push(a),t.splice(0,1),t.length>0?e.handleFixAttendance(t):(e.fixCurrentDay=null,e.cancelFix=!0))})).catch((function(t){e.fixCurrentDay=null,e.cancelFix=!0}))}else this.$message.error(this.$t("rule.updateAtt.notChoose"))},cancelFixAttendance:function(){var e=this,t=function(){e.dialogFixVisible=!1,e.cancelFix=!0,e.fixedDay=[],e.fixCurrentDay=new Date,e.selectedDay=[]};this.cancelFix?t():this.$confirm(this.$t("rule.updateAtt.cancelTitle"),this.$t("table.confirmTitle")).then((function(e){t()}))},ratetime:function(e){var t=[],a=["range1","range2","range3"];return a.forEach((function(a){e[a]&&t.push("".concat(e[a]["time1"],"-").concat(e[a]["time2"]))})),t.join("|")},showTag:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return!(!e||!t)&&Object(d["a"])(e,t)===1*a},tagText:function(e,t){return 1===Object(d["a"])(e,t)?this.$t("rule.components.tomorrow"):this.$t("rule.components.yesterday")},getList:function(){var e=this;this.listLoading=!0,Object(i["d"])(this.listQuery).then((function(t){e.list=t.data.items,e.total=t.data.total,e.listLoading=!1}))},getOptions:function(){var e=this;Object(o["f"])().then((function(t){e.person_options=t.data}))},getSelectedPersons:function(e){var t=this;Object(i["k"])(e).then((function(e){t.selected_persons=e.data}))},handleFilter:function(){this.listQuery.page=1,this.getList()},sortChange:function(e){var t=e.prop,a=e.order;"id"===t&&this.sortByID(a)},sortByID:function(e){this.listQuery.sort="ascending"===e?"+id":"-id",this.handleFilter()},resetTemp:function(){this.temp={id:void 0,name:"",person:[],days:"",checktype:1,range1:{time1:"",time2:"",late_time:"",left_early:"",work_begin:"",work_end:"",offwork_begin:"",offwork_end:""},range2:{},range3:{},sync:!1},this.selected_persons=[],this.attendance_days=[],this.cleanTreePerson()},handleCreate:function(e){var t=this;this.resetTemp(),1===e?(this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick((function(){t.$refs["dataForm"].clearValidate()}))):2===e&&(this.dialogTakVisible=!1,this.visTree=!1,this.$nextTick((function(){t.dialogTakVisible=!0})))},parseForm:function(e){return""===e.late_time&&(e.late_time=-1),""===e.left_early&&(e.left_early=-1),void 0!==e.late_time&&(e.late_time=parseInt(e.late_time)),void 0!==e.left_early&&(e.left_early=parseInt(e.left_early)),e},reparseTime:function(e){return e=this.parseForm(e),e.range1&&(e.range1=this.parseForm(e.range1)),e.range2&&(e.range2=this.parseForm(e.range2)),e.range3&&(e.range3=this.parseForm(e.range3)),e},createData:function(){var e=this;this.$refs["dataForm"].validate((function(t){if(t){e.temp.person=e.$refs.personTree.getCheckedKeys(),e.temp.days=e.attendance_days.join(",");var a=Object.assign({},e.temp);Object(i["a"])(e.reparseTime(a)).then((function(t){e.temp.sync=!1,e.list.unshift(t.data),e.dialogFormVisible=!1,e.$notify({title:e.$t("table.successTitle"),message:e.$t("table.updateSuccess"),type:"success",duration:2e3})}))}}))},tackTurnsVisable:function(e){this.dialogTakVisible=e},handleSchedule:function(){var e=this;Object(i["j"])({}).then((function(t){var a=t.data;e.dialogScheduleVisible=!0,e.$nextTick((function(){e.scheduleDatas=a.schedules,e.scheduleHeaders=a.dates}))}))},handleUpdate:function(e){var t=this,a=Object.assign({},e);if(this.time_keys.forEach((function(e){})),a.sync=!1,this.temp=a,1===e.type)return this.dialogTakVisible=!1,this.visTree=!1,this.$nextTick((function(){t.dialogTakVisible=!0})),"";this.getSelectedPersons({rule_id:e.id}),this.attendance_days=e.days.split(","),this.dialogStatus="update",this.dialogFormVisible=!0,this.cleanTreePerson(),this.$nextTick((function(){t.$refs["dataForm"].clearValidate()}))},updateData:function(){var e=this;this.$refs["dataForm"].validate((function(t){if(t){e.temp.person=e.$refs.personTree.getCheckedKeys(),e.temp.days=e.attendance_days.join(",");var a=Object.assign({},e.temp);Object(i["l"])(e.reparseTime(a)).then((function(t){e.temp.sync=!1;var a=!0,n=!1,r=void 0;try{for(var s,i=e.list[Symbol.iterator]();!(a=(s=i.next()).done);a=!0){var o=s.value;if(o.id===e.temp.id){var l=e.list.indexOf(o);e.list.splice(l,1,t.data);break}}}catch(c){n=!0,r=c}finally{try{a||null==i.return||i.return()}finally{if(n)throw r}}e.dialogFormVisible=!1,e.$notify({title:e.$t("table.successTitle"),message:e.$t("table.updateSuccess"),type:"success",duration:2e3})}))}}))},handleDelete:function(e){var t=this;Object(i["b"])(e).then((function(){t.$notify({title:t.$t("table.successTitle"),message:t.$t("table.deleteSuccess"),type:"success",duration:2e3});var a=t.list.indexOf(e);t.list.splice(a,1)}))},getSortClass:function(e){var t=this.listQuery.sort;return t==="+".concat(e)?"ascending":t==="-".concat(e)?"descending":""},getDaysName:function(e){var t=this;if(!e)return"";var a=[];return e.split(",").sort().forEach((function(e){t.days.forEach((function(t){t.id===e&&a.push(t.name)}))})),a.join(",")},cleanTreePerson:function(){"undefined"!==typeof this.$refs.personTree&&"undefined"!==this.$refs.personTree.setCheckedKeys&&this.$refs.personTree.setCheckedKeys([])}}},R=L,P=(a("409b"),Object(y["a"])(R,n,r,!1,null,"4cc27a5a",null));t["default"]=P.exports},"8d41":function(e,t,a){},c466:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return l}));var n=a("7618"),r=(a("28a5"),a("9a04")),s=a("75fc");function i(e){var t="";t=0===e.getMonth()?e.getFullYear()-1+"-12":e.getFullYear()+"-"+("0"+e.getMonth()).slice(-2);var a="".concat(t,"-01"),n="".concat(t,"-")+Object(r["a"])(Date,Object(s["a"])(t.split("-")).concat([0])).getDate();return[new Date(a),new Date(n)]}var o=function(e){var t=(e||"").split(":");if(t.length>=2){var a=parseInt(t[0],10),n=parseInt(t[1],10),r=t[2]?parseInt(t[2],10):0;return new Date(2e3,1,1,a,n,r)}return new Date},l=function(e,t){var a="object"===Object(n["a"])(e)?e:o(e),r="object"===Object(n["a"])(t)?t:o(t),s=a.getMinutes()+60*a.getHours(),i=r.getMinutes()+60*r.getHours();return s===i?0:s>i?1:-1}}}]);